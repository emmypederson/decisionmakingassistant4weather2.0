import requests
from flask import Flask, render_template, request

app = Flask(__name__)

# Get the weather data using the OpenWeatherMap API
def get_weather_data(api_key, city):
    url = f'http://api.openweathermap.org/data/2.5/weather?q={city}&appid={api_key}&units=metric'
    response = requests.get(url)
    if response.status_code == 200:
        return response.json()
    else:
        return None

# Function to get clothing recommendation based on temperature
def get_clothing_recommendation(temperature, weather_conditions):
    # Clothing recommendations based on temperature
    if temperature < 0:
        return "Wear a heavy winter jacket, gloves, and boots."
    elif 0 <= temperature < 10:
        return "Wear a warm jacket, gloves, and boots or tennis shoes."
    elif 10 <= temperature < 20:
        if 'rain' in weather_conditions:
            return "Wear a waterproof jacket and boots, and consider an umbrella."
        return "Wear a sweatshirt or light jacket with pants or jeans."
    elif 20 <= temperature < 30:
        if 'rain' in weather_conditions:
            return "Wear a light jacket or t-shirt and carry an umbrella."
        return "Wear a t-shirt or tank top with shorts or light pants."
    else:  # temperature >= 30
        if 'rain' in weather_conditions:
            return "Wear a light t-shirt and shorts, but bring an umbrella."
        return "Wear a tank top and shorts, and sandals."

# Home route for the web app
@app.route('/')
def home():
    return render_template('index.html')

# Route to process the city input and show clothing recommendation
@app.route('/get_clothing', methods=['POST'])
def get_clothing():
    city = request.form['city']
    api_key = 'your_openweathermap_api_key'  # Replace with your OpenWeatherMap API key
    
    weather_data = get_weather_data(api_key, city)
    
    if weather_data:
        temperature = weather_data['main']['temp']
        weather_conditions = [condition['main'].lower() for condition in weather_data['weather']]
        recommendation = get_clothing_recommendation(temperature, weather_conditions)
        
        # Return the result to the user
        return render_template('result.html', city=city, temperature=temperature, 
                               weather_conditions=weather_conditions, recommendation=recommendation)
    else:
        return render_template('error.html', city=city)

if __name__ == '__main__':
    app.run(debug=True)

